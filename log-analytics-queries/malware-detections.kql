// Malware detections over time
SecurityEvent
| where EventID == 1116  // Windows Defender malware detection
| parse EventData with * '<Data Name="Threat Name">' ThreatName '</Data>' *
| summarize DetectionCount = count() by ThreatName, bin(TimeGenerated, 1d)
| order by TimeGenerated desc
